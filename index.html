<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Webpack в React</title>

<!--    следующие строки убрать, если будет использоваться webpack-->
    <script crossorigin src="https://unpkg.com/react@16/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.25.0/babel.min.js"></script>
<!-- Load an icon library -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <link rel="stylesheet" href="stylesheets/screen.css">
    <link rel="stylesheet" href="stylesheets/bootstrap-grid.css">
</head>
<body>
    <div id="app"></div>
<!--    раскомментировать, если будет использоваться webpack-->
        <script src="public/bundle.js"></script>

<!--    если будет использоваться webpack - весь код ниже переместитиь в файл app.jsx-->
<!--        <script type="text/babel">-->
<!--        </script>-->
<!--        <script src="https://www.youtube.com/iframe_api"></script>-->
        <script type="text/javascript">
            // load API
            var tag = document.createElement('script');
            tag.src = "https://www.youtube.com/iframe_api";
            var firstScriptTag = document.getElementsByTagName('script')[0];
            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

            // src="https://www.youtube.com/embed/DhDMu9_Sfyw?rel=0&amp;controls=0&amp;showinfo=0&loop=0&autoplay=1&autohide=1&wmode=opaque&enablejsapi=1&mute=1&modestbranding=1"
            function onYouTubeIframeAPIReady() {
                console.log("Youtube player ready!!!");
                elyaPlayer = new YT.Player('elyaVideoPlayer', {
                    height: '360',
                    width: '640',
                    videoId: 'cpSJF2FDP2A',
                    playerVars: { 'autoplay': 1,
                        'controls': 0, // Player controls do not display in the player.
                        'rel': 0, // If the parameter's value is set to 0, then the player does not show related videos.
                        'modestbranding': 1 // Set the parameter value to 1 to prevent the YouTube logo from displaying in the control bar.
                    },
                    events: {
                        'onReady': onPlayerReady,
                        'onStateChange': onPlayerStateChange
                    }
                });
                console.log("Youtube player init object: ", elyaPlayer);
            }

            function onPlayerStateChange(event) {
                if (event.data === YT.PlayerState.ENDED) {
                    event.target.playVideo();
                }
            }
            function onPlayerReady(event) {
                console.log("Event target: ", event.target);
                elyaPlayer = event.target;
                elyaPlayer.playVideo();
            }

            // define player
            console.log("Start script, init var \"elyaPlayer\"");
            var elyaPlayer;

            // переключение воиспроизведения по нажатию на зону с видео(при этом не контактируем с самой iframe напрямую)
            let stub = document.getElementsByClassName("stub-youtube")[0];
            console.log("Youtube-stub element", stub);
            stub.addEventListener('click', function() {
                console.log("Elya player: ", elyaPlayer);
                console.log("Elya player state: ", elyaPlayer.getPlayerState());
                if (typeof elyaPlayer.getPlayerState == "function") {
                    if (elyaPlayer.getPlayerState() === 1) {
                        elyaPlayer.pauseVideo();
                        console.log("Pause video");
                    } else {
                        elyaPlayer.playVideo();
                        console.log("Play video");
                    }
                }
            });

            //setTimeout(onYouTubeIframeAPIReadyFirst, 3000);
        </script>
    </body>
</html>